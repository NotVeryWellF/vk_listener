# Listener для Сообществ ВК
Сервис для получения новых постов из сообществ вк, который получает данные
о новых постах раз в некоторое время (Зависит от количества указанных сообществ, так как
количество запросов ограничено 5000 запросами в сутки) и отправляет новые посты в топик kafka
`posts`

## Конфигурация
Конфигурация происходит в файле `config.yml`. \
Чтобы сконфигурировать сервис нужно скопировать файл `example.config.yml` в 
`config.yml` и заполнить нужные поля:
- `login` и `password` от ВК
- `number_of_posts` - количество последних постов, которые будут взяты из сообществ в самом начале и при каждой дальнейшей итерации
- `communities` - список сообществ для получения постов (указывается короткая ссылка или номер сообщества, например `proglib` для сообщества "Библиотека Программистов") в том же формате, как и в example файле

Примечание: от количества постов зависит период подгрузки новых постов, он вычисляется по формуле: \
len(`communities`) * ((24 * 60 * 60)/5000) \
То есть примерно 18 секунд ждя одного сообщества, 35 для двух, и т.д.

## Деплой
1. Клонировать репозиторий и перейти в директорию проекта
> git clone `repo_link` && cd vk_listener
2. Скопировать файл `example.config.yml` в `config.yml` и заменить данные
> cp `example.config.yml` `config.yml`
3. Поднять docker-compose
> docker-compose up --build -d
- Можно и не в daemon:
> docker-compose up --build
4. Проверить работу после полного запуска сервиса можно через контейнер kafka
> docker-compose exec kafka bash
5. Внутри контейнера можно получить все записи в нашем топике (должны быть записи о последних постах из указанных сообществ)
> kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic posts --from-beginning
6. Также не выходя из контейнера после запуска 5. пункта можно проверить добавление новых постов, если одно из сообществ принадлежит вам (или подождать появления новых в других). После добавления каждого нового поста, должна появляться новая запись.